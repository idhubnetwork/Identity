# 去中心化数字身份产品方案
## 生成去中心化数字身份
### 功能定义
用户新建一个自我独立的去中心化数字身份，包括生成身份标识符密钥对、身份找回密钥对、在智能合约注册身份记录（ERC1484）和创建信息声明智能合约（ERC735、是否实现待定）。
### 使用场景
新用户使用新密钥对新建一个去中心化数字身份
### 功能流程图

### 功能流程
* 前置条件 - 下载IDHub移动端App（数字身份钱包）
* 功能规则
	1. 生成两组ECDSA密钥对，一组用作身份标识符，一组用作身份找回
	2. 将身份注册到ERC1484合约`createIdentity`，其中
		* `recoveryAddress`是上一步身份找回密钥对地址
		* `identity`表现为`associatedAddress`形式，值是上一步身份标识符密钥对地址
		* `resolvers`包括`ERC1056`智能合约地址[DID]和`ERC725RegistryResolver`智能合约地址[Claims]（是否实现待定）
	3. 在`ERC725RegistryResolver`合约中调用`create725`为用户建立ERC725档案以用于可验证声明的链上发布（是否实现待定）
* 后置流程 - 身份信息认证

### 功能原型

### 测试要点

### 功能作用或优势
用户通过区块链可以使用自我确权的去中心化数字身份，由于非对称加密的特点，去中心化数字身份完全由用户自主管理。通过智能合约记录属性可以使去中心化数字身份具有现实意义，信息声明智能合约则可以提供身份信息可信的保障。

## 创建去中心化数字身份
### 功能定义
用户使用提前准备好的密钥对创建一个自我独立的去中心化数字身份，包括在智能合约注册身份记录（ERC1484）和创建信息声明智能合约（ERC735、是否实现待定）。
### 使用场景
新用户使用已拥有的密钥对创建一个去中心化数字身份
### 功能流程图

### 功能流程
* 前置条件
	* 下载IDHub移动端App（数字身份钱包）
	* 两组ECDSA密钥对，一组用作身份标识符，一组用作身份找回，支持格式为助记词
* 功能规则 
	1. 将身份注册到ERC1484合约`createIdentity`，其中
		* `recoveryAddress`是提前准备好的身份找回密钥对地址
		* `identity`表现为`associatedAddress`形式，值是提前准备好的身份标识符密钥对地址
		* `resolvers`包括`ERC1056`智能合约地址[DID]和`ERC725RegistryResolver`智能合约地址[Claims]（是否实现待定）
	2. 在`ERC725RegistryResolver`合约中调用`create725`为用户建立ERC725档案以用于可验证声明的链上发布（是否实现待定）
* 后置流程 - 身份信息认证

### 功能原型

### 测试要点

### 功能作用或优势
用户通过区块链可以使用自我确权的去中心化数字身份，由于非对称加密的特点，去中心化数字身份完全由用户自主管理。通过智能合约记录属性可以使去中心化数字身份具有现实意义，信息声明智能合约则可以提供身份信息可信的保障。

## 恢复去中心化数字身份
### 功能定义
用户使用已注册过的密钥对在另一个设备恢复原来拥有的去中心化数字身份。
### 使用场景
原用户将去中心化数字身份更换到另一移动端设备。
### 功能流程图

### 功能流程
* 前置条件
	* 新设备下载IDHub移动端App（数字身份钱包）
	* 已在旧设备拥有去中心化数字身份
* 功能规则
	1. 手动填入或二维码扫描录入身份标识符和身份找回密钥对的私钥，支持格式如下
		* 十六进制字符串
		* 助记词（推荐格式）
		* Keystore文件
	2. 从智能合约读取相关信息展示去中心化数字身份主页
* 后置流程 - 去中心化数字身份主页

### 功能原型

### 测试要点

### 功能作用或优势
用户通过区块链可以使用自我确权的去中心化数字身份，由于非对称加密的特点，去中心化数字身份完全由用户自主管理。通过智能合约记录属性可以使去中心化数字身份具有现实意义，信息声明智能合约则可以提供身份信息可信的保障。

## 保存去中心化数字身份找回密钥
**可选方案之一，应继续研究其他解决方案**
### 功能定义
提示用户务必通过冷存储形式保存找回密钥对的私钥
### 使用场景
每次新生成、创建或恢复去中心化数字身份之后提示用户保存找回密钥对的私钥
### 功能流程图

### 功能流程
* 前置条件 - 新生成、创建或恢复去中心化数字身份之后
* 功能规则
	1. 提示用户冷存储找回密钥对的私钥，然后点击下一步
	2. 乱序验证用户的冷存储行为
		* 顺序还原正确则通过进入主页
		* 顺序还原错误则退回上一步
* 后置流程 - 去中心化数字身份主页

### 功能原型

## 找回去中心化数字身份
### 功能定义
用户通过找回密钥对的私钥在App内找回重建去中心化数字身份。
### 使用场景
用户丢失设备之后在另一设备的App内通过找回密钥重建已丢失设备内的去中心化数字身份。
### 功能流程图

### 功能流程
* 前置条件
	* 新设备下载IDHub移动端App（数字身份钱包）
	* 冷存储的找回密钥对的私钥
	* 原有数字身份标识符（EIN或数字身份以太坊账户地址）
* 功能规则
	1. 用户进入找回页面填入以下数据并确定
		* 想要找回的数字身份以太坊账户地址（可选）
		* 想要找回的EIN
	2. 用户选取重建方式
		* 重新生成新的身份标识符密钥对，其中私钥保存且地址作为`newAssociatedAddress `参数的值进入下一步
		* 亦或者用户自己手动输入或二维码录入身份标识符密钥对的私钥，计算出地址作为`newAssociatedAddress `参数的值进入下一步
	3. 用户手动输入或二维码扫描录入原有身份找回密钥对的私钥并进行本地保存
	4. 调用`IdentityRegistry `合约（ERC1484）的`triggerRecovery`接口
	5. App读取合约数据显示身份主页
* 后置流程 - 去中心化数字身份主页

### 功能原型

### 测试要点

### 功能作用或优势
用户通过区块链可以使用自我确权的去中心化数字身份，由于非对称加密的特点，去中心化数字身份完全由用户自主管理。通过智能合约记录属性可以使去中心化数字身份具有现实意义，信息声明智能合约则可以提供身份信息可信的保障。